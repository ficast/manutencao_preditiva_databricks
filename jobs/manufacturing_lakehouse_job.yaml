resources:
  jobs:
    Manufacturing_Lakehouse_Pipeline:
      name: Manufacturing Lakehouse Pipeline
      timeout_seconds: 7200
      tasks:
        - task_key: silver_equipment_clean
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/silver/equipment_clean
            base_parameters:
              catalog: manufatura_lakehouse
              schema_bronze: bronze
              schema_silver: silver
            source: WORKSPACE
          description: Limpeza e normalização de equipamentos
        - task_key: gold_dim_equipamento
          depends_on:
            - task_key: silver_equipment_clean
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/gold/dim_equipamento
            base_parameters:
              catalog: manufatura_lakehouse
              schema_silver: silver
              schema_gold: gold
            source: WORKSPACE
          description: Dimensão equipamento (snapshot atual)
        - task_key: gold_dim_tempo
          depends_on:
            - task_key: silver_equipment_clean
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/gold/dim_tempo
            base_parameters:
              catalog: manufatura_lakehouse
              schema_silver: silver
              schema_gold: gold
            source: WORKSPACE
          description: Dimensão de tempo (calendário)
        - task_key: silver_equipment_scd
          depends_on:
            - task_key: silver_equipment_clean
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/silver/equipment_scd
            base_parameters:
              catalog: manufatura_lakehouse
              schema_bronze: bronze
              schema_silver: silver
            source: WORKSPACE
          description: SCD Type 2 para equipamentos
        - task_key: gold_dim_equipamento_scd
          depends_on:
            - task_key: silver_equipment_scd
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/gold/dim_equipamento_scd
            base_parameters:
              catalog: manufatura_lakehouse
              schema_silver: silver
              schema_gold: gold
            source: WORKSPACE
          description: Dimensão equipamento SCD Type 2
        - task_key: silver_iot_readings_clean
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/silver/iot_readings_clean
            base_parameters:
              catalog: manufatura_lakehouse
              schema_bronze: bronze
              schema_silver: silver
            source: WORKSPACE
          description: Limpeza de leituras IoT
        - task_key: gold_fact_iot_agregado
          depends_on:
            - task_key: gold_dim_equipamento
            - task_key: gold_dim_tempo
            - task_key: silver_iot_readings_clean
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/gold/fact_iot_agregado
            base_parameters:
              catalog: manufatura_lakehouse
              schema_silver: silver
              schema_gold: gold
            source: WORKSPACE
          description: Fato agregado de IoT (por hora)
        - task_key: gold_vw_tendencias_sensores
          depends_on:
            - task_key: gold_fact_iot_agregado
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/gold/vw_tendencias_sensores
            base_parameters:
              catalog: manufatura_lakehouse
              schema_gold: gold
            source: WORKSPACE
          description: View de tendências de sensores
        - task_key: silver_maintenance_orders_clean
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/silver/maintenance_orders_clean
            base_parameters:
              catalog: manufatura_lakehouse
              schema_bronze: bronze
              schema_silver: silver
            source: WORKSPACE
          description: Limpeza de ordens de manutenção
        - task_key: gold_dim_tecnico
          depends_on:
            - task_key: silver_maintenance_orders_clean
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/gold/dim_tecnico
            base_parameters:
              catalog: manufatura_lakehouse
              schema_silver: silver
              schema_gold: gold
            source: WORKSPACE
          description: Dimensão de técnicos
        - task_key: gold_dim_tipo_manutencao
          depends_on:
            - task_key: silver_maintenance_orders_clean
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/gold/dim_tipo_manutencao
            base_parameters:
              catalog: manufatura_lakehouse
              schema_silver: silver
              schema_gold: gold
            source: WORKSPACE
          description: Dimensão de tipos de manutenção
        - task_key: gold_fact_manutencao
          depends_on:
            - task_key: gold_dim_tipo_manutencao
            - task_key: gold_dim_tecnico
            - task_key: gold_dim_tempo
            - task_key: gold_dim_equipamento
            - task_key: silver_maintenance_orders_clean
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/gold/fact_manutencao
            base_parameters:
              catalog: manufatura_lakehouse
              schema_silver: silver
              schema_gold: gold
            source: WORKSPACE
          description: Fato de manutenção
        - task_key: gold_vw_downtime_por_causa
          depends_on:
            - task_key: gold_fact_manutencao
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/gold/vw_downtime_por_causa
            base_parameters:
              catalog: manufatura_lakehouse
              schema_gold: gold
            source: WORKSPACE
          description: View de downtime por causa
        - task_key: silver_production_orders_clean
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/silver/production_orders_clean
            base_parameters:
              catalog: manufatura_lakehouse
              schema_bronze: bronze
              schema_silver: silver
            source: WORKSPACE
          description: Limpeza de ordens de produção
        - task_key: gold_dim_produto
          depends_on:
            - task_key: silver_production_orders_clean
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/gold/dim_produto
            base_parameters:
              catalog: manufatura_lakehouse
              schema_silver: silver
              schema_gold: gold
            source: WORKSPACE
          description: Dimensão de produtos
        - task_key: gold_fact_producao
          depends_on:
            - task_key: gold_dim_produto
            - task_key: gold_dim_equipamento
            - task_key: gold_dim_tempo
            - task_key: silver_production_orders_clean
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/gold/fact_producao
            base_parameters:
              catalog: manufatura_lakehouse
              schema_silver: silver
              schema_gold: gold
            source: WORKSPACE
          description: Fato de produção
        - task_key: gold_vw_oee_diario
          depends_on:
            - task_key: gold_fact_qualidade
            - task_key: gold_dim_tempo
            - task_key: gold_dim_equipamento
            - task_key: gold_fact_manutencao
            - task_key: gold_fact_producao
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/gold/vw_oee_diario
            base_parameters:
              catalog: manufatura_lakehouse
              schema_gold: gold
            source: WORKSPACE
          description: View de OEE diário
        - task_key: silver_quality_inspections_clean
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/silver/quality_inspections_clean
            base_parameters:
              catalog: manufatura_lakehouse
              schema_bronze: bronze
              schema_silver: silver
            source: WORKSPACE
          description: Limpeza de inspeções de qualidade
        - task_key: gold_dim_defeito
          depends_on:
            - task_key: silver_quality_inspections_clean
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/gold/dim_defeito
            base_parameters:
              catalog: manufatura_lakehouse
              schema_silver: silver
              schema_gold: gold
            source: WORKSPACE
          description: Dimensão de códigos de defeito
        - task_key: gold_fact_qualidade
          depends_on:
            - task_key: gold_dim_defeito
            - task_key: gold_dim_tempo
            - task_key: gold_dim_equipamento
            - task_key: silver_quality_inspections_clean
            - task_key: gold_dim_produto
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/gold/fact_qualidade
            base_parameters:
              catalog: manufatura_lakehouse
              schema_silver: silver
              schema_gold: gold
            source: WORKSPACE
          description: Fato de qualidade
        - task_key: gold_vw_equipamentos_criticos
          depends_on:
            - task_key: gold_fact_producao
            - task_key: gold_fact_manutencao
            - task_key: gold_fact_qualidade
          notebook_task:
            notebook_path: /Workspace/Users/filipeyoga@gmail.com/manutencao_preditiva_databricks/models/gold/vw_equipamentos_criticos
            base_parameters:
              catalog: manufatura_lakehouse
              schema_gold: gold
            source: WORKSPACE
          description: View de equipamentos críticos
      queue:
        enabled: true
      performance_target: PERFORMANCE_OPTIMIZED
